<!DOCTYPE html>
<html>
  <head>
    <title>Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>

  <body>
    <div class="container mt-4">
      <!-- HEADER -->
      <div class="d-flex justify-content-between align-items-center mb-4">
        <h3>Dashboard</h3>
        <button id="logout" class="btn btn-danger btn-sm">Logout</button>
      </div>

      <!-- MENU -->
      <div class="row mb-4">
        <div class="col-md-4">
          <a href="items.html" class="btn btn-primary w-100">Manage Items</a>
        </div>
        <div class="col-md-4">
          <a href="suppliers.html" class="btn btn-secondary w-100"
            >Manage Suppliers</a
          >
        </div>
        <div class="col-md-4">
          <a href="purchase.html" class="btn btn-success w-100"
            >Create Purchase</a
          >
        </div>
      </div>

      <!-- INVENTORY SUMMARY -->
      <div class="card">
        <div class="card-header">
          <strong>Inventory Stock</strong>
        </div>
        <div class="card-body p-0">
          <table class="table table-bordered mb-0">
            <thead class="table-light">
              <tr>
                <th>Item Name</th>
                <th width="150">Stock</th>
              </tr>
            </thead>
            <tbody id="inventoryTable">
              <tr>
                <td colspan="2" class="text-center">Loading...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="assets/js/app.js"></script>

    <script>
      if (!localStorage.getItem("token")) {
        window.location.href = "login.html";
      }

      apiRequest({
        url: "/item",
        success: function (res) {
          let rows = "";

          if (!res.data || res.data.length === 0) {
            rows = `<tr><td colspan="2" class="text-center">No data</td></tr>`;
          } else {
            res.data.forEach((item) => {
              rows += `
          <tr>
            <td>${item.name}</td>
            <td>${item.stock}</td>
          </tr>
        `;
            });
          }

          $("#inventoryTable").html(rows);
        },
        error: function () {
          $("#inventoryTable").html(`
      <tr>
        <td colspan="2" class="text-danger text-center">
          Failed to load inventory
        </td>
      </tr>
    `);
        },
      });

      $("#logout").click(function () {
        Swal.fire({
          title: "Logout?",
          showCancelButton: true,
          confirmButtonText: "Yes",
        }).then((result) => {
          if (result.isConfirmed) {
            localStorage.removeItem("token");
            window.location.href = "login.html";
          }
        });
      });
    </script>
  </body>
</html>
